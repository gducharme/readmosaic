# AUTO-GENERATED by seedpipe.tools.compile
# DO NOT EDIT. Changes will be overwritten.
# Source: pipeline.yaml hash: sha256:d15b74f5b0b0db308b62308e9447fd7d1eaa5f5b2be685610fa86ee7b7221ad1
# Contracts hash: sha256:da7fb7e4e9d3ad66fdc6a9db71bdc78268e8206ab9df353348b332de77570731

from __future__ import annotations

import argparse
from datetime import datetime, timezone

from seedpipe.generated.stages import voice as stage_voice

from seedpipe.runtime.ctx import StageContext
from seedpipe.runtime.items import iter_items_deterministic
from seedpipe.runtime.state import append_item_state_row

PIPELINE_ID = 'voice-pipeline'
ITEM_UNIT = 'item'
DETERMINISM_POLICY = 'strict'
STAGES = ['voice']

def now_rfc3339() -> str:
    return datetime.now(timezone.utc).isoformat()

def run(run_config: dict[str, object], attempt: int = 1) -> int:
    run_id = str(run_config['run_id'])
    ctx_base = StageContext.make_base(run_config=run_config)
    ctx = ctx_base.for_stage('voice', attempt=attempt)
    stage_voice.run_whole(ctx)
    return 0

def main() -> None:
    parser = argparse.ArgumentParser(description='Run generated Seedpipe flow')
    parser.add_argument('--run-id', required=True)
    parser.add_argument('--attempt', type=int, default=1)
    args = parser.parse_args()
    code = run(run_config={'run_id': args.run_id}, attempt=args.attempt)
    raise SystemExit(code)

if __name__ == '__main__':
    main()
